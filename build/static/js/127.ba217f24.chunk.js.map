{"version":3,"file":"static/js/127.ba217f24.chunk.js","mappings":"sPAQA,MA4CA,EA5CsBA,KACpB,MAAMC,GAAWC,EAAAA,EAAAA,OAGVC,KAFMC,EAAAA,EAAAA,KAAaC,GAAUA,EAAMC,KAAKC,QAC3BH,EAAAA,EAAAA,KAAaC,GAAUA,EAAMC,KAAKE,eACrCC,EAAAA,EAAAA,OACfC,EAAUP,EAAOQ,IAAI,SACrB,cAAEC,IAAkBR,EAAAA,EAAAA,KAAaC,GAAUA,EAAMQ,QAAQC,QAwB3D,OAtBAC,EAAAA,EAAAA,YAAU,KACRd,GAASe,EAAAA,EAAAA,MAAU,GAClB,CAACf,KAEJc,EAAAA,EAAAA,YAAU,KChB2BE,MDiBnChB,GCjBmCgB,EDkBTC,IACjBA,EAAUC,MACblB,GAASmB,EAAAA,EAAAA,IAASC,EAAAA,EAAAA,IAAS,CAAEC,IAAK,yBAA0BC,KAAM,WACpE,ECrBsCC,UAC5C,IAAK,IAADC,EAAAC,EAAAC,EAAAC,EAAAC,EAAAC,EACF,MAAMC,QAAYC,EAAAA,EAAMrB,IAAI,GAADsB,OAAIC,EAAAA,EAAOC,SAASC,QAAO,sBAAsB,CAC1EC,QAAS,IACJH,EAAAA,EAAOC,SAASE,QACnBC,cAAe,UAAYC,aAAaC,QAAQ,YAIpD,IAAIrB,EAAO,CACTP,cAAuB,QAAVa,EAAEM,EAAIZ,YAAI,IAAAM,GAAM,QAANC,EAARD,EAAUN,YAAI,IAAAO,OAAN,EAARA,EAAgBd,cAC/B6B,yBAAkC,QAAVd,EAAEI,EAAIZ,YAAI,IAAAQ,GAAM,QAANC,EAARD,EAAUR,YAAI,IAAAS,OAAN,EAARA,EAAgBa,yBAC1CC,sBAA+B,QAAVb,EAAEE,EAAIZ,YAAI,IAAAU,GAAM,QAANC,EAARD,EAAUV,YAAI,IAAAW,OAAN,EAARA,EAAgBY,uBAEzCzC,EAAS,CACPsB,KAAMoB,EAAAA,GACNC,QAASzB,IAEXF,EAAGc,EAAIZ,KACT,CAAE,MAAO0B,GACPC,QAAQC,IAAIF,EACd,IDEG,GACA,CAAC5C,KAEJc,EAAAA,EAAAA,YAAU,KCF0BiC,MDG7BtC,GAILT,GCPkC+C,EDOHtC,ECPYc,UAC7C,UACoBQ,EAAAA,EAAMiB,KAAK,GAADhB,OACvBC,EAAAA,EAAOC,SAASC,QAAO,sBAC1B,CACEY,QAEF,CACEX,QAAS,IACJH,EAAAA,EAAOC,SAASE,QACnBC,cAAe,UAAYC,aAAaC,QAAQ,WAIxD,CAAE,MAAOU,GACPjD,EAAS,CACPsB,KAAM4B,EAAAA,GACNP,QAAS,CACPtB,IAAK4B,EAAIE,SAASC,WAClBC,OAAQJ,EAAIE,SAASE,SAG3B,IDf0C,GACvC,CAACrD,EAAUS,EAASE,KAGrB2C,EAAAA,EAAAA,MAAA,OAAAC,SAAA,EACEC,EAAAA,EAAAA,KAACC,EAAAA,GAAU,KACXH,EAAAA,EAAAA,MAAA,OAAKI,UAAU,iDAAgDH,SAAA,EAC7DC,EAAAA,EAAAA,KAACG,EAAAA,GAAS,KACVH,EAAAA,EAAAA,KAAA,OAAKE,UAAU,wBAAuBH,UACpCC,EAAAA,EAAAA,KAACI,EAAAA,GAAU,OAEbJ,EAAAA,EAAAA,KAACK,EAAAA,GAAS,SAER,C","sources":["layout/DefaultLayout.js","actions/dropbox.js"],"sourcesContent":["import React, { useEffect } from 'react'\nimport { AppContent, AppSidebar, AppFooter, AppHeader, AppToast } from '../components/app/index'\nimport { useDispatch, useSelector } from 'react-redux'\nimport { getUser } from 'src/actions/auth'\nimport { getConfigurationSystem, setDropboxAccessToken } from 'src/actions/dropbox'\nimport { useSearchParams } from 'react-router-dom'\nimport { setToast } from 'src/actions/toast'\n\nconst DefaultLayout = () => {\n  const dispatch = useDispatch()\n  const user = useSelector((state) => state.auth.user)\n  const permissions = useSelector((state) => state.auth.permissions)\n  const [params] = useSearchParams(),\n    codeURI = params.get('code'),\n    { token_dropbox } = useSelector((state) => state.dropbox.token)\n\n  useEffect(() => {\n    dispatch(getUser())\n  }, [dispatch])\n\n  useEffect(() => {\n    dispatch(\n      getConfigurationSystem((configRes) => {\n        if (!configRes.data) {\n          dispatch(setToast(AppToast({ msg: 'Sin token para dropbox', type: 'error' })))\n        }\n      }),\n    )\n  }, [dispatch])\n\n  useEffect(() => {\n    if (!codeURI) {\n      return\n    }\n\n    dispatch(setDropboxAccessToken(codeURI))\n  }, [dispatch, codeURI, token_dropbox])\n\n  return (\n    <div>\n      <AppSidebar />\n      <div className=\"wrapper d-flex flex-column min-vh-100 bg-light\">\n        <AppHeader />\n        <div className=\"body flex-grow-1 px-3\">\n          <AppContent />\n        </div>\n        <AppFooter />\n      </div>\n    </div>\n  )\n}\n\nexport default DefaultLayout\n","import axios from 'axios'\nimport config from 'src/server.config'\nimport { GET_AUTHORIZATION_CODE, DROPBOX_ERROR } from './types'\n\nexport const getConfigurationSystem = (cb) => async (dispatch) => {\n  try {\n    const res = await axios.get(`${config.instance.baseURL}/api/configuration`, {\n      headers: {\n        ...config.instance.headers,\n        Authorization: 'Bearer ' + localStorage.getItem('token'),\n      },\n    })\n\n    let data = {\n      token_dropbox: res.data?.data?.token_dropbox,\n      token_dropbox_expires_in: res.data?.data?.token_dropbox_expires_in,\n      token_dropbox_refresh: res.data?.data?.token_dropbox_refresh,\n    }\n    dispatch({\n      type: GET_AUTHORIZATION_CODE,\n      payload: data,\n    })\n    cb(res.data)\n  } catch (error) {\n    console.log(error)\n  }\n}\n\nexport const setDropboxAccessToken = (code) => async (dispatch) => {\n  try {\n    const res = await axios.post(\n      `${config.instance.baseURL}/api/token/dropbox`,\n      {\n        code,\n      },\n      {\n        headers: {\n          ...config.instance.headers,\n          Authorization: 'Bearer ' + localStorage.getItem('token'),\n        },\n      },\n    )\n  } catch (err) {\n    dispatch({\n      type: DROPBOX_ERROR,\n      payload: {\n        msg: err.response.statusText,\n        status: err.response.status,\n      },\n    })\n  }\n}\n"],"names":["DefaultLayout","dispatch","useDispatch","params","useSelector","state","auth","user","permissions","useSearchParams","codeURI","get","token_dropbox","dropbox","token","useEffect","getUser","cb","configRes","data","setToast","AppToast","msg","type","async","_res$data","_res$data$data","_res$data2","_res$data2$data","_res$data3","_res$data3$data","res","axios","concat","config","instance","baseURL","headers","Authorization","localStorage","getItem","token_dropbox_expires_in","token_dropbox_refresh","GET_AUTHORIZATION_CODE","payload","error","console","log","code","post","err","DROPBOX_ERROR","response","statusText","status","_jsxs","children","_jsx","AppSidebar","className","AppHeader","AppContent","AppFooter"],"sourceRoot":""}