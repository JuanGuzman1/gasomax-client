"use strict";(self.webpackChunkgasomax_client=self.webpackChunkgasomax_client||[]).push([[127],{9741:(e,o,a)=>{a.r(o),a.d(o,{default:()=>f});var t=a(2791),n=a(7941),s=a(9101),r=a(374),d=a(5294),i=a(6647),l=a(591);var u=a(1087),c=a(4166),v=a(9463),p=a(7462),x=a(184);const f=()=>{const e=(0,s.I0)(),o=(0,s.v9)((e=>e.auth.user)),[a]=((0,s.v9)((e=>e.auth.permissions)),(0,u.lr)()),f=a.get("code"),{token_dropbox:h}=(0,s.v9)((e=>e.dropbox.token));return(0,t.useEffect)((()=>{e((0,r.PR)())}),[e]),(0,t.useEffect)((()=>{var a,t,n,s,r,d;if(null===o||void 0===o||!o.data||null===o||void 0===o||!o.data.user||(null===o||void 0===o||null===(a=o.data)||void 0===a||null===(t=a.user)||void 0===t||null===(n=t.files)||void 0===n?void 0:n.length)<=0)return;let i=null===o||void 0===o||null===(s=o.data)||void 0===s||null===(r=s.user)||void 0===r||null===(d=r.files)||void 0===d?void 0:d.find((e=>e.tag===p.O.img));i&&(console.log("image"),e((0,v.U6)(i.id,i.extension,(o=>{e({type:l.qu,payload:o})}))))}),[o,e]),(0,t.useEffect)((()=>{var o;e((o=o=>{o.data||e((0,c.f)((0,n.Kv)({msg:"Sin token para dropbox",type:"error"})))},async e=>{try{var a,t,n,s,r,u;const c=await d.Z.get("".concat(i.Z.instance.baseURL,"/api/configuration"),{headers:{...i.Z.instance.headers,Authorization:"Bearer "+localStorage.getItem("token")}});let v={token_dropbox:null===(a=c.data)||void 0===a||null===(t=a.data)||void 0===t?void 0:t.token_dropbox,token_dropbox_expires_in:null===(n=c.data)||void 0===n||null===(s=n.data)||void 0===s?void 0:s.token_dropbox_expires_in,token_dropbox_refresh:null===(r=c.data)||void 0===r||null===(u=r.data)||void 0===u?void 0:u.token_dropbox_refresh};e({type:l.G9,payload:v}),o(c.data)}catch(c){console.log(c)}}))}),[e]),(0,t.useEffect)((()=>{var o;f&&e((o=f,async e=>{try{await d.Z.post("".concat(i.Z.instance.baseURL,"/api/token/dropbox"),{code:o,redirect_uri:i.Z.instance.return_uri},{headers:{...i.Z.instance.headers,Authorization:"Bearer "+localStorage.getItem("token")}})}catch(a){e({type:l.mx,payload:{msg:a.response.statusText,status:a.response.status}})}}))}),[e,f,h]),(0,x.jsxs)("div",{children:[(0,x.jsx)(n.S8,{}),(0,x.jsxs)("div",{className:"wrapper d-flex flex-column min-vh-100 bg-light",children:[(0,x.jsx)(n.tf,{}),(0,x.jsx)("div",{className:"body flex-grow-1 px-3",children:(0,x.jsx)(n.Lk,{})}),(0,x.jsx)(n.qh,{})]})]})}}}]);
//# sourceMappingURL=127.e80b12f0.chunk.js.map