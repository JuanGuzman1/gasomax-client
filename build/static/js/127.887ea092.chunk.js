"use strict";(self.webpackChunkgasomax_client=self.webpackChunkgasomax_client||[]).push([[127],{9741:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var o=a(2791),s=a(7941),r=a(9101),n=a(374),d=a(5294),i=a(6647),l=a(591);var c=a(1087),u=a(4166),p=a(9463),x=a(184);const f=()=>{const e=(0,r.I0)(),t=(0,r.v9)((e=>e.auth.user)),[a]=((0,r.v9)((e=>e.auth.permissions)),(0,c.lr)()),f=a.get("code"),{token_dropbox:h}=(0,r.v9)((e=>e.dropbox.token));return(0,o.useEffect)((()=>{e((0,n.PR)())}),[e]),(0,o.useEffect)((()=>{if(!t.data.user&&t.data.user.files.length<=0)return;let a=t.data.user.files.find((e=>"img"===e.tag));e((0,p.U6)(a.id,a.extension,(t=>{e({type:l.qu,payload:t})})))}),[t,e]),(0,o.useEffect)((()=>{var t;e((t=t=>{t.data||e((0,u.f)((0,s.Kv)({msg:"Sin token para dropbox",type:"error"})))},async e=>{try{var a,o,s,r,n,c;const u=await d.Z.get("".concat(i.Z.instance.baseURL,"/api/configuration"),{headers:{...i.Z.instance.headers,Authorization:"Bearer "+localStorage.getItem("token")}});let p={token_dropbox:null===(a=u.data)||void 0===a||null===(o=a.data)||void 0===o?void 0:o.token_dropbox,token_dropbox_expires_in:null===(s=u.data)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.token_dropbox_expires_in,token_dropbox_refresh:null===(n=u.data)||void 0===n||null===(c=n.data)||void 0===c?void 0:c.token_dropbox_refresh};e({type:l.G9,payload:p}),t(u.data)}catch(u){console.log(u)}}))}),[e]),(0,o.useEffect)((()=>{var t;f&&e((t=f,async e=>{try{await d.Z.post("".concat(i.Z.instance.baseURL,"/api/token/dropbox"),{code:t,redirect_uri:i.Z.instance.return_uri},{headers:{...i.Z.instance.headers,Authorization:"Bearer "+localStorage.getItem("token")}})}catch(a){e({type:l.mx,payload:{msg:a.response.statusText,status:a.response.status}})}}))}),[e,f,h]),(0,x.jsxs)("div",{children:[(0,x.jsx)(s.S8,{}),(0,x.jsxs)("div",{className:"wrapper d-flex flex-column min-vh-100 bg-light",children:[(0,x.jsx)(s.tf,{}),(0,x.jsx)("div",{className:"body flex-grow-1 px-3",children:(0,x.jsx)(s.Lk,{})}),(0,x.jsx)(s.qh,{})]})]})}}}]);
//# sourceMappingURL=127.887ea092.chunk.js.map